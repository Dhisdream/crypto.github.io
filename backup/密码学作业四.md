# 密码学作业四

## 实验题目
首届（2016）全国高校密码数学挑战赛 赛题三
RSA 密码算法是使用最为广泛的公钥密码体制。该体制简单且易于实现，只需要选择5个参数即可（两个素数𝑝和𝑞、模数𝑁=𝑝𝑞、加密指数𝑒和解密指数𝑑）。设𝑚为待加密消息，RSA体制破译相当于已知𝑚^e mod 𝑁，能否还原𝑚的数论问题。目前模数规模为1024比特的RSA 算法一般情况下是安全的，但是如果参数选取不当，同样存在被破译的可能。
有人制作了一个RSA加解密软件（采用的RSA体制的参数特点描述见密码背景部分）。已知该软件发送某个明文的所有参数和加密过程的全部数据（加密案例文件详见附件3-1）。Alice使用该软件发送了一个通关密语，且所有加密数据已经被截获，请问能否仅从加密数据恢复该通关密语及RSA体制参数？如能请给出原文和参数，如不能请给出已恢复部分并说明剩余部分不能恢复的理由？

## 实验过程

通读赛题可知，题目需要运用各种针对RSA的攻击方式将总共21个分片数据进行破解，在查阅了相关资料后，我有了一个大致的思路，攻击方式的原理下面就不在赘述。
首先，我考虑将数据文件中的模数N，公钥e和密文c先提取出来并打印大致观察一下
通过对21个数据的观察，首先我注意到了其中有一些数据选取的e很小，其中：Frame7、Frame11和Frame15的e都为3，而Frame3、Frame8、Frame12、Frame16和Frame20的e都为5。于是考虑这两组数据进行低加密指数攻击，最终对于第一组数据没有成功破解，而第二组数据成功破解并且明文内容一致

接着我想到了类似的，如果当e选取过大时，d相对可能会出现较小的情况，此时可能可以利用wiener攻击，但经过尝试后失败了，这里便不再给出。

接着注意到Frame0与Frame4有相同的模数，考虑对其进行公共模数攻击，攻击成功

接着我想到了模数可能存在公因子时的攻击（由于翻转课堂时这一部分正好是我讲的，印象比较深刻），经过遍历发现了Frame1和Frame18的模数有公因子，于是进行攻击，攻击成功

此时我已经不知道还有什么可以看出特征进行的攻击可用了，于是考虑直接对N进行分解的相关攻击，首先我尝试了基于Fermat分解的攻击，这里我对每个数据设置的时间上限是10秒，最终只有Frame10成功被破解

接着我又尝试了基于Pollard p-1分解的攻击，最终Frame2、Frame6和Frame19成功被破解

## 实验代码
在这个仓库  
https://github.com/Dhisdream/crypto_code